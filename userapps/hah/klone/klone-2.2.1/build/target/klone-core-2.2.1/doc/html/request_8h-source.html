<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>KLone: request.h Source File</title>
<link href="kl.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>request.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * Copyright (c) 2005, 2006 by KoanLogic s.r.l. &lt;http://www.koanlogic.com&gt;</span>
00003 <span class="comment"> * All rights reserved.</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * This file is part of KLone, and as such it is subject to the license stated</span>
00006 <span class="comment"> * in the LICENSE file which you have received as part of this distribution.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * $Id: request.h,v 1.22 2009/10/23 14:08:28 tho Exp $</span>
00009 <span class="comment"> */</span>
00010 
00011 <span class="preprocessor">#ifndef _KLONE_REQUEST_H_</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define _KLONE_REQUEST_H_</span>
00013 <span class="preprocessor"></span>
00014 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00015 <span class="preprocessor">#include &lt;time.h&gt;</span>
00016 <span class="preprocessor">#include &lt;u/libu.h&gt;</span>
00017 <span class="preprocessor">#include &lt;klone/header.h&gt;</span>
00018 <span class="preprocessor">#include &lt;klone/io.h&gt;</span>
00019 <span class="preprocessor">#include &lt;<a class="code" href="http_8h.html">klone/http.h</a>&gt;</span>
00020 <span class="preprocessor">#include &lt;klone/vars.h&gt;</span>
00021 <span class="preprocessor">#include &lt;klone/addr.h&gt;</span>
00022 <span class="preprocessor">#include &lt;klone/vhost.h&gt;</span>
00023 
00024 <span class="preprocessor">#ifdef __cplusplus</span>
00025 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00026 <span class="preprocessor">#endif</span>
00027 <span class="preprocessor"></span>
00028 <span class="keyword">struct </span>request_s;
00029 <span class="keyword">typedef</span> <span class="keyword">struct </span>request_s request_t;
00030 
00031 <span class="keywordtype">int</span> request_create(http_t *h, request_t **prq);
00032 <span class="keywordtype">int</span> request_free(request_t *rq);
00033 <span class="keywordtype">int</span> request_bind(request_t *rq, io_t *);
00034 <span class="keywordtype">int</span> request_parse_header(request_t *rq, 
00035         <span class="keywordtype">int</span> (*is_valid_url)(<span class="keywordtype">void</span>*, <span class="keyword">const</span> <span class="keywordtype">char</span> *, size_t),
00036         <span class="keywordtype">void</span>* arg);
00037 <span class="keywordtype">int</span> request_parse_data(request_t *rq);
00038 
00039 io_t* <a class="code" href="group__request.html#ga7">request_io</a>(request_t *rq);
00040 http_t* <a class="code" href="group__request.html#ga8">request_get_http</a>(request_t *rq);
00041 kaddr_t* <a class="code" href="group__request.html#ga9">request_get_addr</a>(request_t *rq);
00042 kaddr_t* <a class="code" href="group__request.html#ga10">request_get_peer_addr</a>(request_t *rq);
00043 header_t* <a class="code" href="group__request.html#ga11">request_get_header</a>(request_t *rq);
00044 field_t* <a class="code" href="group__request.html#ga12">request_get_field</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00045 <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="group__request.html#ga13">request_get_field_value</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00046 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga14">request_get_client_request</a>(request_t *rq);
00047 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga15">request_get_uri</a>(request_t *rq);
00048 <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="group__request.html#ga16">request_get_protocol</a>(request_t *rq);
00049 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga17">request_get_filename</a>(request_t *rq);
00050 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga18">request_get_resolved_filename</a>(request_t *rq);
00051 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga19">request_get_query_string</a>(request_t *rq);
00052 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga20">request_get_path_info</a>(request_t *rq);
00053 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga21">request_get_resolved_path_info</a>(request_t *rq);
00054 <span class="keywordtype">int</span> <a class="code" href="group__request.html#ga22">request_get_method</a>(request_t *rq);
00055 ssize_t <a class="code" href="group__request.html#ga23">request_get_content_length</a>(request_t *rq);
00056 time_t <a class="code" href="group__request.html#ga24">request_get_if_modified_since</a>(request_t *rq);
00057 <span class="keywordtype">int</span> request_is_encoding_accepted(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *encoding);
00058 
00059 <span class="keywordtype">int</span> request_set_field(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
00060 <span class="keywordtype">int</span> request_set_client_request(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *ln);
00061 <span class="keywordtype">int</span> request_set_uri(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri,
00062         <span class="keywordtype">int</span> (*is_valid_uri)(<span class="keywordtype">void</span>*, <span class="keyword">const</span> <span class="keywordtype">char</span> *, size_t),
00063         <span class="keywordtype">void</span>* arg);
00064 <span class="keywordtype">int</span> request_set_filename(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *filename);
00065 <span class="keywordtype">int</span> request_set_method(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *method);
00066 <span class="keywordtype">int</span> request_set_path_info(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *path_info);
00067 <span class="keywordtype">int</span> request_set_query_string(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *query);
00068 <span class="keywordtype">int</span> request_set_resolved_filename(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *resolved);
00069 <span class="keywordtype">int</span> request_set_resolved_path_info(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *resolved);
00070 <span class="keywordtype">int</span> request_set_addr(request_t *rq, kaddr_t *addr);
00071 <span class="keywordtype">int</span> request_set_peer_addr(request_t *rq, kaddr_t *addr);
00072 <span class="keywordtype">void</span> request_set_cgi(request_t *rq, <span class="keywordtype">int</span> cgi);
00073 <span class="keywordtype">void</span> request_clear_uri(request_t *rq);
00074 
00075 <span class="keywordtype">int</span> request_print(request_t *rq);
00076 
00077 <span class="keyword">enum</span> { MIME_TYPE_BUFSZ = 256 };
00078 
00079 vars_t *<a class="code" href="group__request.html#ga40">request_get_uploads</a>(request_t *rq);
00080 <span class="keywordtype">int</span> <a class="code" href="group__request.html#ga41">request_get_uploaded_file</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, size_t idx, 
00081     <span class="keywordtype">char</span> local_filename[U_FILENAME_MAX], <span class="keywordtype">char</span> client_filename[U_FILENAME_MAX], 
00082     <span class="keywordtype">char</span> mime_type[MIME_TYPE_BUFSZ], size_t *file_size);
00083 
00084 vars_t *<a class="code" href="group__request.html#ga42">request_get_args</a>(request_t *rq);
00085 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga43">request_get_arg</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00086 
00087 vars_t *<a class="code" href="group__request.html#ga44">request_get_getargs</a>(request_t *rq);
00088 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga45">request_get_getarg</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00089 
00090 vars_t *<a class="code" href="group__request.html#ga46">request_get_postargs</a>(request_t *rq);
00091 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga47">request_get_postarg</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00092 
00093 vars_t *<a class="code" href="group__request.html#ga48">request_get_cookies</a>(request_t *rq);
00094 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__request.html#ga49">request_get_cookie</a>(request_t *rq, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00095 
00096 vhost_t *request_get_vhost(request_t *rq);
00097 <span class="keywordtype">int</span> request_set_vhost(request_t *rq, vhost_t *vhost);
00098 
00099 <span class="comment">/* internal */</span>
00100 <span class="keyword">struct </span>supplier_s;
00101 <span class="keywordtype">void</span> request_set_sup_info(request_t *, <span class="keyword">struct</span> supplier_s*, <span class="keywordtype">void</span> *, time_t);
00102 <span class="keywordtype">void</span> request_get_sup_info(request_t *, <span class="keyword">struct</span> supplier_s **, <span class="keywordtype">void</span> **, time_t *);
00103 
00104 <span class="preprocessor">#ifdef __cplusplus</span>
00105 <span class="preprocessor"></span>}
00106 <span class="preprocessor">#endif </span>
00107 <span class="preprocessor"></span>
00108 <span class="preprocessor">#endif</span>
</pre></div>
    </div>

    <div id="footer">
        <p>Copyright &copy; 
    2005-2007 - <a href="http://www.koanlogic.com">KoanLogic S.r.l.</a> - All rights reserved
         | Valid <a
        href="http://jigsaw.w3.org/css-validator/">CSS</a> &amp; <a
        href="http://validator.w3.org/">XHTML</a> | powered by <a
        href="/klone/index.html">KLone</a> </p>
    </div>
</body>

</html>


