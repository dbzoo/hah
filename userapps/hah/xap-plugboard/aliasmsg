#!/usr/bin/lua
-- $Id$
lapp = require("pl.lapp")
config = require("pl.config")
stringx = require("pl.stringx")
socket = require("socket")
local args = lapp
[[
  Various flags and option types
      <alias> (string)       Alias command
]]
require("xap")

local cmd = string.format([[
xap-header
{
class=alias
}
command
{
text=%s
}]],args.alias)

local ini = config.read("/etc/xap.d/system.ini")
local instance = nil

if ini['xap'] then
   instance = ini.xap['instance']
end
if instance == nil then 
   instance=stringx.split(socket.dns.gethostname(),'.')[1] 
end

xap.init("dbzoo."..instance..".aliasmsg","FF00DF00")
xap.sendShort(cmd)
