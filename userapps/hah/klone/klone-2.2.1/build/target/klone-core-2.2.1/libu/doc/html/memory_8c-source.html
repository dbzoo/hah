<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>LibU: memory.c Source File</title>
<link href="kl.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a></div>
<h1>memory.c</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * Copyright (c) 2005-2008 by KoanLogic s.r.l. - All rights reserved.</span>
00003 <span class="comment"> */</span>
00004 
00005 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00006 <span class="preprocessor">#include &lt;toolbox/memory.h&gt;</span>
00007 
00008 <span class="keyword">typedef</span> <span class="keyword">struct </span>u_memory_funcs_s
00009 {
00010     <span class="keywordtype">void</span> *(*f_malloc) (size_t);
00011     <span class="keywordtype">void</span> *(*f_calloc) (size_t, size_t);
00012     <span class="keywordtype">void</span> *(*f_realloc) (<span class="keywordtype">void</span> *, size_t);
00013     void (*f_free) (<span class="keywordtype">void</span> *);
00014 } u_memory_fns_t;
00015 
00016 <span class="comment">/* defaults to LibC memory allocator */</span>
00017 <span class="keyword">static</span> u_memory_fns_t u_memory_fns = { malloc, calloc, realloc, free };
00018 
<a name="l00025"></a><a class="code" href="group__alloc.html#ga0">00025</a> <span class="keywordtype">void</span> <a class="code" href="group__alloc.html#ga0">u_memory_set_malloc</a> (<span class="keywordtype">void</span> *(*f_malloc) (size_t))
00026 {
00027     u_memory_fns.f_malloc = f_malloc;
00028 }
00029 
<a name="l00031"></a><a class="code" href="group__alloc.html#ga1">00031</a> <span class="keywordtype">void</span> <a class="code" href="group__alloc.html#ga1">u_memory_set_calloc</a> (<span class="keywordtype">void</span> *(*f_calloc) (size_t, size_t))
00032 {
00033     u_memory_fns.f_calloc = f_calloc;
00034 }
00035 
<a name="l00037"></a><a class="code" href="group__alloc.html#ga2">00037</a> <span class="keywordtype">void</span> <a class="code" href="group__alloc.html#ga2">u_memory_set_realloc</a> (<span class="keywordtype">void</span> *(*f_realloc) (<span class="keywordtype">void</span> *, size_t))
00038 {
00039     u_memory_fns.f_realloc = f_realloc;
00040 }
00041 
<a name="l00043"></a><a class="code" href="group__alloc.html#ga3">00043</a> <span class="keywordtype">void</span> <a class="code" href="group__alloc.html#ga3">u_memory_set_free</a> (<span class="keywordtype">void</span> (*f_free) (<span class="keywordtype">void</span> *))
00044 {
00045     u_memory_fns.f_free = f_free;
00046 }
00047 
<a name="l00049"></a><a class="code" href="group__alloc.html#ga4">00049</a> <span class="keywordtype">void</span> *<a class="code" href="group__alloc.html#ga4">u_malloc</a> (size_t sz)
00050 {
00051     <span class="keywordflow">return</span> u_memory_fns.f_malloc(sz);
00052 }
00053 
<a name="l00055"></a><a class="code" href="group__alloc.html#ga5">00055</a> <span class="keywordtype">void</span> *<a class="code" href="group__alloc.html#ga5">u_calloc</a> (size_t cnt, size_t sz)
00056 {
00057     <span class="keywordflow">return</span> u_memory_fns.f_calloc(cnt, sz);
00058 }
00059 
<a name="l00061"></a><a class="code" href="group__alloc.html#ga6">00061</a> <span class="keywordtype">void</span> *<a class="code" href="group__alloc.html#ga6">u_zalloc</a> (size_t sz)
00062 {
00063     <span class="keywordflow">return</span> u_memory_fns.f_calloc(1, sz);
00064 }
00065 
<a name="l00067"></a><a class="code" href="group__alloc.html#ga7">00067</a> <span class="keywordtype">void</span> *<a class="code" href="group__alloc.html#ga7">u_realloc</a> (<span class="keywordtype">void</span> *ptr, size_t sz)
00068 {
00069     <span class="keywordflow">return</span> u_memory_fns.f_realloc(ptr, sz);
00070 }
00071 
<a name="l00073"></a><a class="code" href="group__alloc.html#ga8">00073</a> <span class="keywordtype">void</span> <a class="code" href="group__alloc.html#ga8">u_free</a> (<span class="keywordtype">void</span> *ptr)
00074 {
00075     <span class="keywordflow">if</span> (ptr)
00076         u_memory_fns.f_free(ptr);
00077 }
00078 
</pre></div><hr>
<div>
  <div style="text-align:left">
    <a href="http://www.koanlogic.com/kl/cont/gb/html/products.html">&larr;Products</a>
  </div>
  <div style="text-align:center;">
    &copy; 2005-2008 - <a href="http://www.koanlogic.com">KoanLogic S.r.l.</a> - All rights reserved
  </div>
</div>

</body>
</html>
